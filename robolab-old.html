<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>mehamasum.com</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://swisnl.github.io/jQuery-contextMenu/css/screen.css" type="text/css"/>
    <link rel="stylesheet" href="https://swisnl.github.io/jQuery-contextMenu/css/theme.css" type="text/css"/>
    <link rel="stylesheet" href="https://swisnl.github.io/jQuery-contextMenu/css/theme-fixes.css" type="text/css"/>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/github.min.css">
    <link href="https://swisnl.github.io/jQuery-contextMenu/dist/jquery.contextMenu.css" rel="stylesheet" type="text/css" />
    <script src="https://swisnl.github.io/jQuery-contextMenu/dist/jquery.contextMenu.js" type="text/javascript"></script>
    <script src="https://swisnl.github.io/jQuery-contextMenu/dist/jquery.ui.position.min.js" type="text/javascript"></script>
    <script src="https://swisnl.github.io/jQuery-contextMenu/js/main.js" type="text/javascript"></script>

	<style>
	html,body {  
        font-family: "consolas", Times, serif; font-size: 12px;
        background:#fff; height:100%; margin:0; padding:0; overflow:hidden; 
    }
	canvas { position:absolute; top:0; left:0 }
    img { position:absolute; }
    .draggable:hover { cursor: move; }
	</style>
</head>


<body>
    <script>
        $(function(){
            $.contextMenu({
                selector: '.move_dropdownbase', 
                trigger: 'left',
                callback: function(key, options) {
                    if (key=="0") {
                        $(.move_option).text("forward");
                    }
                    else if (key=="1") {
                        $(.move_option).text("backword");
                    }
                },
                items: {
                    "0": {name: "forward"},
                    "1": {name: "backword"}
                }
            });
        });
    </script>


    <svg id="svg" width="600" height="400">

        <rect x="5" y="5" width="590" height="390" stroke="#ff0099" stroke-width="5" fill="none" ></rect>

        <g id="move_shape" transform="translate(100,100)">

            <path id="move_base" fill="#5ba58c" 
                    d="
                    m 0,8 
                    A 8,8 0 0,1 8,0 
                    H 15 
                    l 6,4 3,0 6,-4 
                    H 150 
                    v 30
                    H 29.5 
                    l -6,4 -3,0 -6,-4 
                    H 8 a 8,8 0 0,1 -8,-8 
                    z
                    ">
        
            </path>

            <text x="20" y="18" fill="#fff">move</text>

            <g class="move_dropdownbase" >
                <rect x="70" y="5"  rx="4" ry="4" fill="#fff" height="20" width="70"></rect>
                <text x="77" y="18" class="move_option">
                    forward
                    <tspan style="fill: rgb(91, 128, 165);">
                    â–¾
                    </tspan>
                </text>
            </g>

            </g>
                        

        </g>

        <g id="forward_shape" class="draggable" transform="translate(10,10)">
            <path fill="#5b67a5" d="m 0,0 H 70 v 25 H 0 V 20 c 0,-10 -8,8 -8,-7.5 s 8,2.5 8,-7.5 z"></path>
            <text x="10" y="16" fill="#fff"> forward </text>
        </g>

    </svg>


    <script>
    var f = function(){

        function Draggable(element){
            this.element = element;



            var self = this;

            var move = function(event){

                self.element.style.stroke = "#ffee00";
                if(self.dragStart != undefined){ self.dragStart();}

                //console.log(event);

                //don't bubble this event - mousedown
                event.stopPropagation();
                //prevent any default action
                event.preventDefault();

                var original = self.element.getAttribute("transform");
                original = original.slice(10, -1).split(',');
                //console.log(original);

                var originalLeft=parseInt(original[0]), originalTop=parseInt(original[1]);
                //var originalLeft = parseInt(window.getComputedStyle(this).x);
                //var originalTop = parseInt(window.getComputedStyle(this).y);
                //console.log("> "+originalLeft);
                //console.log("> "+originalTop);

                var mouseDownX = event.clientX;
                var mouseDownY = event.clientY;
                //console.log(">> "+mouseDownX);
                //console.log(">> "+mouseDownY)

                function dragMe(event){
                    var translated = "translate("+ (originalLeft + event.clientX - mouseDownX) + "," + (originalTop + event.clientY - mouseDownY) + ")";
                    //console.log(translated);
                    self.element.setAttribute("transform", translated);
                    event.stopPropagation();
                }

                function dropMe(event){
                    document.removeEventListener('mousemove',dragMe,true);
                    document.removeEventListener('mouseup',dropMe,true);
                    if(self.dragDrop !== undefined){ self.dragDrop();}
                    event.stopPropagation();

                    self.element.style.stroke = "none";
                }

                document.addEventListener('mouseup',dropMe,true);
                document.addEventListener('mousemove',dragMe,true);

            };

            this.element.addEventListener('mousedown',move,false);

        }


        var move_shape = document.getElementById("move_shape");
        new Draggable(move_shape);

        var forward_shape = document.getElementById("forward_shape");
        new Draggable(forward_shape);


    };

    window.addEventListener('load', f ,false);
    </script>

</body>
</html>